#!/usr/bin/env bash
# of-shell-root: same as of-shell, but run as root inside the container
set -euo pipefail

ENGINE="${OPENFOAM_ENGINE:-docker}"
IMAGE="${OPENFOAM_IMAGE:-docker.io/opencfd/openfoam-default}"
TAG="${OPENFOAM_TAG:-2406}"

TTY_OPTS=()
if [ -t 0 ] && [ -t 1 ]; then
  TTY_OPTS=(-it)
fi

exec "${ENGINE}" run --rm "${TTY_OPTS[@]}" \
  --user 0:0 \
  -v "$PWD:$PWD" -w "$PWD" \
  "${IMAGE}:${TAG}" \
  -- bash -i

